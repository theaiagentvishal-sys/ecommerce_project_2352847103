<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products - E-SHOP</title>
    <link rel="icon" type="image/png" href="public/images/favicon.png">
    <link href="https://fonts.googleapis.com/css?family=Poppins:200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="public/bootstrap.css">
    <link rel="stylesheet" href="public/font-awesome.css">
    <link rel="stylesheet" href="public/fe/themify-icons.css">
    <link rel="stylesheet" href="public/fe/style.css">
    <!-- Auth System -->
    <script src="public/auth.js" defer></script>
    <script src="public/shopping-experience.js" defer></script>
    <script src="public/shopping-flow.js" defer></script>
    <link rel="stylesheet" href="public/shopping-flow.css">
    <style>
        .products-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px;padding:30px 0}.product-card{background:#fff;border-radius:6px;overflow:hidden;box-shadow:0 1px 4px rgba(0,0,0,.08);transition:transform .2s}.product-card:hover{transform:translateY(-3px)}.product-image{width:100%;height:180px;background:#f5f5f5;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden}.product-image img{width:100%;height:100%;object-fit:cover}.wishlist-badge{position:absolute;top:8px;right:8px;background:#fff;width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 1px 3px rgba(0,0,0,.1)}.product-info{padding:12px}.product-name{font-weight:600;margin:0 0 3px;font-size:14px;line-height:1.3}.product-rating{color:#FFC107;font-size:11px;margin:0 0 4px}.product-price{color:#F7941D;font-weight:700;font-size:16px;margin:0 0 8px}.btn-add-cart{background:#F7941D;color:#fff;padding:8px;width:100%;border:0;border-radius:3px;cursor:pointer;font-weight:600;font-size:13px}.filter-sidebar{background:#fff;padding:15px;border-radius:6px;margin-bottom:15px;box-shadow:0 1px 4px rgba(0,0,0,.08)}.filter-group{margin-bottom:15px}.filter-group h4{margin:0 0 8px;font-weight:600;font-size:13px}.filter-option{margin-bottom:6px;font-size:13px}@media(max-width:768px){.products-grid{grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:8px}.topbar,.middle-inner{padding:8px 0}}.container{padding:0 8px}@media(max-width:480px){.products-grid{grid-template-columns:repeat(2,1fr)}.col-lg-3{display:none}}
    </style>
</head>
<body>
    <header class="header shop">
        <div class="topbar">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6"><div class="left-content"><ul class="list-main"><li><i class="ti-location-pin"></i> <span>London Oxford Street, UK</span></li></ul></div></div>
                    <div class="col-lg-6"><div class="right-content"><ul class="list-main"><li id="userStatusDisplay" style="display:none"><i class="ti-user"></i> <a href="profile.html"><span style="color:#27ae60;font-weight:600" id="userNameDisplay">User</span></a> | <a href="javascript:void(0)" onclick="handleLogout()" style="color:#e74c3c">Logout</a></li><li id="guestDisplay"><a href="track-order.html">Track Order</a></li><li id="guestDisplay2"><a href="login.html">Login</a> / <a href="register.html">Register</a></li></ul></div></div>
                </div>
            </div>
        </div>
        <div class="middle-inner">
            <div class="container">
                <div class="row">
                    <div class="col-lg-2"><div class="logo"><a href="index.html"><img src="public/images/logo.jpg" alt="logo"></a></div></div>
                    <div class="col-lg-8"><div class="search-bar-top"><div class="search-bar"><form><input placeholder="Search..." type="search"><button class="btnn"><i class="ti-search"></i></button></form></div></div></div>
                    <div class="col-lg-2"><div class="right-bar"><div class="sinlge-bar shopping"><a href="wishlist.html"><i class="fa fa-heart-o"></i> <span class="total-count" id="wishlistCount">0</span></a></div><div class="sinlge-bar shopping"><a href="cart.html"><i class="ti-bag"></i> <span class="total-count" id="cartCount">0</span></a></div></div></div>
                </div>
            </div>
        </div>
        <div class="header-inner">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12"><div class="menu-area"><nav class="navbar navbar-expand-lg"><div class="navbar-collapse"><ul class="nav main-menu navbar-nav"><li><a href="index.html">Home</a></li><li><a href="products.html">Products</a></li><li><a href="blog.html">Blog</a></li><li><a href="contact.html">Contact</a></li><li><a href="admin-dashboard.html">Admin</a></li></ul></div></nav></div></div>
                </div>
            </div>
        </div>
    </header>

    <div class="container" style="padding:30px 0">
        <div class="row">
            <div class="col-lg-3 col-md-4">
                <div class="filter-sidebar">
                    <div class="filter-group">
                        <h4>Category</h4>
                        <div class="filter-option"><input type="checkbox" value="footwear"> Footwear</div>
                        <div class="filter-option"><input type="checkbox" value="garments"> Garments</div>
                        <div class="filter-option"><input type="checkbox" value="accessories"> Accessories</div>
                    </div>
                    <div class="filter-group">
                        <h4>Price Range</h4>
                        <div class="filter-option"><input type="checkbox" value="0-50"> $0 - $50</div>
                        <div class="filter-option"><input type="checkbox" value="50-100"> $50 - $100</div>
                        <div class="filter-option"><input type="checkbox" value="100+"> $100+</div>
                    </div>
                </div>
            </div>
            <div class="col-lg-9 col-md-8">
                <h2 style="margin-bottom:20px">All Products</h2>
                <div class="products-grid" id="productsGrid"></div>
            </div>
        </div>
    </div>

    <footer class="footer-area footer" style="margin-top:30px">
        <div class="footer-top">
            <div class="container">
                <div class="row">
                    <div class="col-lg-3 col-md-6"><div class="single-footer"><h4>About</h4><p>Premium online shopping</p></div></div>
                    <div class="col-lg-3 col-md-6"><div class="single-footer links"><h4>Quick Links</h4><ul><li><a href="index.html">Home</a></li><li><a href="products.html">Products</a></li><li><a href="blog.html">Blog</a></li><li><a href="contact.html">Contact</a></li></ul></div></div>
                    <div class="col-lg-3 col-md-6"><div class="single-footer links"><h4>Support</h4><ul><li><a href="#">FAQ</a></li><li><a href="#">Returns</a></li><li><a href="#">Shipping</a></li></ul></div></div>
                    <div class="col-lg-3 col-md-6"><div class="single-footer"><h4>Contact</h4><ul><li>Email: info@eshop.com</li><li>Phone: +1-800-ESHOP</li></ul></div></div>
                </div>
            </div>
        </div>
    </footer>

    <script>
function renderProducts(){
    let html='';
    ShoppingExperience.products.forEach(product=>{
        const stars='â˜…'.repeat(product.rating)+'â˜†'.repeat(5-product.rating);
        html+=`<div class="product-card" onclick="trackProductView('${product.name.replace(/'/g, "\\'")}')">
            <div class="product-image">
                <img src="${product.img || 'https://via.placeholder.com/180?text=' + encodeURIComponent(product.name)}" alt="${product.name}" loading="lazy" onerror="this.src='https://via.placeholder.com/180?text=' + encodeURIComponent('${product.name}')">
                <div class="wishlist-badge" onclick="event.stopPropagation(); addToWishlist('${product.name.replace(/'/g, "\\'")}', ${product.price})">
                    <i class="fa fa-heart-o"></i>
                </div>
            </div>
            <div class="product-info">
                <h4 class="product-name">${product.name}</h4>
                <div class="product-rating">${stars}</div>
                <div class="product-price">$${product.price}</div>
                <button class="btn-add-cart" onclick="event.stopPropagation(); ShoppingFlow.quickAddToCart('${product.name.replace(/'/g, "\\'")}', ${product.price}, '${product.cat}', '${product.img}')">
                    ðŸ›’ Add to Cart
                </button>
            </div>
        </div>`;
    });
    document.getElementById('productsGrid').innerHTML=html;
    CartManager.updateCartDisplay();
}

renderProducts();

// Track product views
function trackProductView(productName) {
    ShoppingExperience.trackView(productName);
    console.log('Product viewed:', productName);
}

// Add to wishlist
function addToWishlist(productName, price) {
    if (!UserSession.isLoggedIn()) {
        window.location.href = 'login.html';
        return false;
    }
    let wishlist = JSON.parse(localStorage.getItem('wishlist_' + UserSession.getCurrentUser().userId) || '[]');
    const exists = wishlist.find(item => item.name === productName);
    if (!exists) {
        wishlist.push({name: productName, price: price, addedAt: new Date().toISOString()});
        localStorage.setItem('wishlist_' + UserSession.getCurrentUser().userId, JSON.stringify(wishlist));
        alert('âœ“ Added to Wishlist');
    } else {
        alert('Already in Wishlist');
    }
    return true;
}
    </script>
</body>
</html>